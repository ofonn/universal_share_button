<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Universal Share (Navigator + Escape)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .platform-button {
        transition: all 0.15s ease-in-out;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -2px rgba(0, 0, 0, 0.1);
      }
      .platform-button:hover {
        transform: translateY(-2px);
      }
      .platform-button:active {
        transform: translateY(0);
      }
      pre {
        white-space: pre-wrap;
      }
      .note {
        font-size: 0.9rem;
        color: #6b7280;
      }
    </style>
  </head>
  <body class="min-h-screen bg-gray-100 p-4 flex items-center justify-center">
    <div class="w-full max-w-lg bg-white p-6 md:p-8 rounded-xl shadow-2xl">
      <h1 class="text-3xl font-extrabold text-gray-800 mb-2">
        Universal Share (Navigator + Escape)
      </h1>
      <p class="note mb-4">
        Click an app below. This will always open an external page (browser).
        The external page will immediately attempt the native
        <code>navigator.share()</code> call and do nothing else if it fails.
      </p>

      <div id="message-box" class="hidden"></div>

      <div class="space-y-4">
        <button
          onclick="onChoose('telegram')"
          class="platform-button w-full bg-[#229ED9] text-white p-4 rounded-lg font-bold"
        >
          Share â†’ Telegram (open external)
        </button>
        <button
          onclick="onChoose('whatsapp')"
          class="platform-button w-full bg-[#25D366] text-white p-4 rounded-lg font-bold"
        >
          Share â†’ WhatsApp (open external)
        </button>
        <button
          onclick="onChoose('discord')"
          class="platform-button w-full bg-[#5865F2] text-white p-4 rounded-lg font-bold"
        >
          Share â†’ Discord (open external)
        </button>
        <button
          onclick="onChoose('signal')"
          class="platform-button w-full bg-[#3A76F0] text-white p-4 rounded-lg font-bold"
        >
          Share â†’ Signal (open external)
        </button>
      </div>

      <div class="mt-6 pt-4 border-t">
        <h3 class="text-lg font-bold text-gray-700 mb-2">Content to Share:</h3>
        <pre
          class="bg-gray-50 p-3 rounded-lg text-sm text-gray-800 overflow-x-auto"
          id="share-content-preview"
        ></pre>
      </div>
    </div>

    <script>
          // Content to share
          const SHARE_TEXT = `SECRET SLUT ðŸ¤«ðŸ”ž ðŸ”—
      tegram.me/o3hatzB969EyZDg8
      https://tegram.me/XDOUBLEBANG
      xtelegram.me/RATPIMAX
      JOIN Check it Out6`;
          const SHARE_URL = 'https://tegram.me/XDOUBLEBANG';
          const CONTENT = SHARE_TEXT + "

      " + SHARE_URL;

          document.getElementById('share-content-preview').textContent = CONTENT;

          // Detect Telegram WebApp (Mini App)
          function inTelegramWebApp() {
            return !!(window.Telegram && window.Telegram.WebApp);
          }

          // Show temporary message
          function showMessage(msg, cls = 'bg-gray-500') {
            const box = document.getElementById('message-box');
            box.innerHTML = msg;
            box.className = `p-3 mb-4 rounded-lg text-sm font-semibold text-white ${cls}`;
            box.classList.remove('hidden');
            setTimeout(() => box.classList.add('hidden'), 3000);
          }

          // Called when user picks a platform
          function onChoose(platform) {
            // Build escape URL which includes the chosen platform and content
            const encoded = encodeURIComponent(CONTENT);
            const escapeUrl = `${location.origin}${location.pathname}?platform=${encodeURIComponent(platform)}&content=${encoded}`;

            // Always open the external page. Use Telegram.WebApp.openLink when inside the Mini App to force external open.
            if (inTelegramWebApp()) {
              try {
                Telegram.WebApp.openLink(escapeUrl, { try_instant_view: false });
                return;
              } catch (e) {
                // if that fails, fall through to location change
                console.warn('openLink failed, falling back to direct navigation', e);
              }
            }

            // Not in Telegram Mini App (or openLink failed) â€” navigate to external page (same page with params)
            window.location.href = escapeUrl;
          }

          // On the external page: if platform param exists, immediately call navigator.share and do NOTHING else if it fails
          async function autoRunFromParams() {
            const params = new URLSearchParams(location.search);
            const platform = params.get('platform');
            const encodedContent = params.get('content');
            if (!platform) return; // nothing to auto-run

            const text = encodedContent ? decodeURIComponent(encodedContent) : CONTENT;

            if (navigator.share) {
              try {
                await navigator.share({ title: 'Share', text, url: SHARE_URL });
                // success - do not perform any fallbacks
              } catch (err) {
                // deliberately do nothing on failure per your instruction
                console.warn('navigator.share failed on redirect page â€” no fallbacks will be performed', err);
              }
            } else {
              // Deliberately do nothing when navigator.share is not available
              console.warn('navigator.share not available on redirect page â€” no fallbacks will be performed');
            }
          }

          // Run on load
          window.addEventListener('DOMContentLoaded', () => {
            autoRunFromParams();
          });
    </script>
  </body>
</html>
